report-findings-bullet-3:
  sql: SELECT
        CALL_FOR_SERVICE as call_for_service,
        COUNT(*) as N,
        PRINTF('%.4f', COUNT(*) * 1.0 / (SELECT COUNT(*) FROM aa_main_table)) as share
      FROM
        aa_main_table
      GROUP BY
        CALL_FOR_SERVICE
  title: "(2020 annual report) Findings regarding RIPA Stop Data Bullet Point 3"
  description_html: "<b>95.3 percent of stops were officer-initiated</b>, while 4.7 percent of stops were in response to a call for service, radio call, or dispatch."

race-ethnicity-by-agency:
  sql: SELECT
        b.AGENCY_NAME as agency_name,
        rae_codes.RACE_ETHNICITY as race_ethnicity,
        COUNT(rae.RAE_FULL) as N
      FROM
        race_ethnicity as rae
      INNER JOIN aa_main_table as b ON b.UNIQUE_ID = rae.UNIQUE_ID
      INNER JOIN race_ethnicity_codes as rae_codes ON rae.RAE_FULL = rae_codes.CODE
      GROUP BY
        agency_name,
        rae.RAE_FULL
  title: "Race / Ethnicity by Agency Name"
  description_html: "Stops by race/ethnicity by agency."

race-ethnicity-by-reason-for-stop:
  sql: SELECT
        rae_codes.RACE_ETHNICITY as race_ethnicity,
        rfs_codes.REASON_FOR_STOP as reason_for_stop,
        COUNT(main.REASON_FOR_STOP) as total_stops
      FROM
        aa_main_table as main
        INNER JOIN race_ethnicity as rae ON rae.UNIQUE_ID = main.UNIQUE_ID
        INNER JOIN race_ethnicity_codes as rae_codes ON rae.RAE_FULL = rae_codes.CODE
        INNER JOIN reason_for_stop_codes as rfs_codes ON main.REASON_FOR_STOP = rfs_codes.CODE
      GROUP BY
        main.REASON_FOR_STOP,
        rae.RAE_FULL
      ORDER BY
        rae_codes.RACE_ETHNICITY
  title: "Reason for Stop by Race / Ethnicity "
  description_html: "A higher percentage of Black individuals were stopped for reasonable suspicion than any other racial identity group."

consent-by-race-ethnicity:
  sql: SELECT
        rae_codes.RACE_ETHNICITY as race_ethnicity,
        SUM(ADS_ASKED_SEARCH_PER) as asked_person_for_consent,
        SUM(ADS_SEARCH_PERS_CONSEN) as person_consented_to_search,
        SUM(ADS_SEARCH_PERSON) as searched_person,
        SUM(bfs.BFS_CONSENT_GIVEN) as bfs_consent_given,
        COUNT(main.REASON_FOR_STOP) as rfs_consentual_encounter_consentual_search
      FROM
        action_taken AS at
      INNER JOIN 
        race_ethnicity AS rae ON rae.UNIQUE_ID = at.UNIQUE_ID
      INNER JOIN
        basis_for_search AS bfs ON bfs.UNIQUE_ID = rae.UNIQUE_ID
      INNER JOIN
        race_ethnicity_codes AS rae_codes ON rae.RAE_FULL = rae_codes.CODE
      LEFT JOIN
        (SELECT UNIQUE_ID, REASON_FOR_STOP FROM aa_main_table WHERE REASON_FOR_STOP = 6) AS main ON main.UNIQUE_ID = rae.UNIQUE_ID
      GROUP BY
        rae.RAE_FULL
  title: "Variables related to consent in searches"
  description_html: "According to RIPA stop data regulations: <br> <b>Consensual search</b> is a search that occurs when a person gives a peace officer consent or permission to search the person or the personâ€™s property. Consent can be given in writing or verbally, or may be implied by conduct. <br> <b>Consensual encounter resulting in a search</b>: A consensual encounter is an interaction in which the officer does not exert any authority over, or use any force on, a person, and the person is free to leave. The officer shall only select this data value if a consensual encounter results in a search, regardless of whether the resulting search is consensual."
