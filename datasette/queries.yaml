report-findings-bullet-3:
  sql: SELECT
        CALL_FOR_SERVICE as call_for_service,
        COUNT(*) as N,
        PRINTF('%.4f', COUNT(*) * 1.0 / (SELECT COUNT(*) FROM aa_main_table)) as share
      FROM
        aa_main_table
      GROUP BY
        CALL_FOR_SERVICE
  title: "(2020 annual report) Findings regarding RIPA Stop Data Bullet Point 3"
  description_html: "<b>95.3 percent of stops were officer-initiated</b>, while 4.7 percent of stops were in response to a call for service, radio call, or dispatch."

race-ethnicity-by-agency:
  sql: SELECT
        b.AGENCY_NAME as agency_name,
        rae_codes.RACE_ETHNICITY as race_ethnicity,
        COUNT(rae.RAE_FULL) as N
      FROM
        race_ethnicity as rae
      INNER JOIN aa_main_table as b ON b.UNIQUE_ID = rae.UNIQUE_ID
      INNER JOIN race_ethnicity_codes as rae_codes ON rae.RAE_FULL = rae_codes.CODE
      GROUP BY
        agency_name,
        rae.RAE_FULL
  title: "Race / Ethnicity by Agency Name"
  description_html: "Stops by race/ethnicity by agency."

race-ethnicity-by-reason-for-stop:
  sql: SELECT
        rae_codes.RACE_ETHNICITY as race_ethnicity,
        rfs_codes.REASON_FOR_STOP as reason_for_stop,
        COUNT(main.REASON_FOR_STOP) as total_stops
      FROM
        aa_main_table as main
        INNER JOIN race_ethnicity as rae ON rae.UNIQUE_ID = main.UNIQUE_ID
        INNER JOIN race_ethnicity_codes as rae_codes ON rae.RAE_FULL = rae_codes.CODE
        INNER JOIN reason_for_stop_codes as rfs_codes ON main.REASON_FOR_STOP = rfs_codes.CODE
      GROUP BY
        main.REASON_FOR_STOP,
        rae.RAE_FULL
      ORDER BY
        rae_codes.RACE_ETHNICITY
  title: "Reason for Stop by Race / Ethnicity "
  description_html: "A higher percentage of Black individuals were stopped for reasonable suspicion than any other racial identity group."

consensual-encounters-resulting-in-search-by-race-ethnicity:
  sql: "SELECT AGENCY_NAME, COUNT(REASON_FOR_STOP) as total_stops, SUM(RAE_BLACK_AFRICAN_AMERICAN) as n_black, SUM(RAE_HISPANIC_LATINO) as n_latinx, SUM(RAE_ASIAN) as n_asian, SUM(RAE_WHITE) as n_white, PRINTF('%.2f', SUM(RAE_BLACK_AFRICAN_AMERICAN)*1.0 / COUNT(REASON_FOR_STOP)) as share_black, PRINTF('%.2f', SUM(RAE_HISPANIC_LATINO)*1.0 / COUNT(REASON_FOR_STOP)) as share_latinx, PRINTF('%.2f', SUM(RAE_ASIAN)*1.0 / COUNT(REASON_FOR_STOP)) as share_asian, PRINTF('%.2f', SUM(RAE_WHITE)*1.0 / COUNT(REASON_FOR_STOP)) as share_white FROM aa_main_table as main INNER JOIN race_ethnicity as rae ON rae.UNIQUE_ID = main.UNIQUE_ID WHERE REASON_FOR_STOP = 6 GROUP BY main.AGENCY_NAME"
  title: "Consensual Encounters Resulting in Search by Race/Ethnicity"
  description_html: "Consensual encounter resulting in search."

consent-given-for-search-by-race-ethnicity:
  sql: "SELECT main.AGENCY_NAME as agency_name, bfs.BFS_CONSENT_GIVEN as consent_given, COUNT(REASON_FOR_STOP) as total_stops, SUM(RAE_BLACK_AFRICAN_AMERICAN) as n_black, SUM(RAE_HISPANIC_LATINO) as n_latinx, SUM(RAE_ASIAN) as n_asian, SUM(RAE_WHITE) as n_white, PRINTF('%.2f', SUM(RAE_BLACK_AFRICAN_AMERICAN)*1.0 / COUNT(REASON_FOR_STOP)) as share_black, PRINTF('%.2f', SUM(RAE_HISPANIC_LATINO)*1.0 / COUNT(REASON_FOR_STOP)) as share_latinx, PRINTF('%.2f', SUM(RAE_ASIAN)*1.0 / COUNT(REASON_FOR_STOP)) as share_asian, PRINTF('%.2f', SUM(RAE_WHITE)*1.0 / COUNT(REASON_FOR_STOP)) as share_white FROM aa_main_table as main INNER JOIN race_ethnicity as rae ON rae.UNIQUE_ID = main.UNIQUE_ID INNER JOIN basis_for_search as bfs on bfs.UNIQUE_ID = rae.UNIQUE_ID GROUP BY main.AGENCY_NAME, bfs.BFS_CONSENT_GIVEN"
  title: "Consensual Searches by Race/Ethnicity"
  description_html: "Basis for search: consent given."

consensual-encounters-resulting-in-consensual-search-by-race-ethnicity:
  sql: "SELECT main.AGENCY_NAME as agency_name, bfs.BFS_CONSENT_GIVEN as consent_given, COUNT(REASON_FOR_STOP) as total_stops, SUM(RAE_BLACK_AFRICAN_AMERICAN) as n_black, SUM(RAE_HISPANIC_LATINO) as n_latinx, SUM(RAE_ASIAN) as n_asian, SUM(RAE_WHITE) as n_white, PRINTF('%.2f', SUM(RAE_BLACK_AFRICAN_AMERICAN)*1.0 / COUNT(REASON_FOR_STOP)) as share_black, PRINTF('%.2f', SUM(RAE_HISPANIC_LATINO)*1.0 / COUNT(REASON_FOR_STOP)) as share_latinx, PRINTF('%.2f', SUM(RAE_ASIAN)*1.0 / COUNT(REASON_FOR_STOP)) as share_asian, PRINTF('%.2f', SUM(RAE_WHITE)*1.0 / COUNT(REASON_FOR_STOP)) as share_white FROM aa_main_table as main INNER JOIN race_ethnicity as rae ON rae.UNIQUE_ID = main.UNIQUE_ID INNER JOIN basis_for_search as bfs on bfs.UNIQUE_ID = rae.UNIQUE_ID WHERE REASON_FOR_STOP = 6 GROUP BY main.AGENCY_NAME, bfs.BFS_CONSENT_GIVEN"
  title: "Consensual Encounters Resulting in Consensual Search by Race/Ethnicity"
  description_html: "Reason for stop: consensual encounter and basis for search: consent given by Race / Ethnicity."
